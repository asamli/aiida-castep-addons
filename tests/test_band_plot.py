from copy import deepcopy
from tempfile import TemporaryDirectory
from pathlib import Path

import aiida.orm as orm
import numpy as np
from aiida.engine import run_get_node
from aiida.plugins import DataFactory, WorkflowFactory
from aiida_castep.data.otfg import upload_otfg_family
from aiida_castep_addons.workflows.band_plot import (
    add_metadata,
    analysis,
    seekpath_analysis,
)
from ase.build import bulk

StructureData = DataFactory("structure")
BandsData = DataFactory("array.bands")
SinglefileData = DataFactory("singlefile")


def test_seekpath_analysis():
    silicon = StructureData(ase=bulk("Si", "diamond", 5.43))
    seekpath = seekpath_analysis(silicon, orm.Dict(dict={}))

    assert "kpoints" in seekpath
    assert "prim_cell" in seekpath


def test_add_metadata():  
    file = SinglefileData(Path("registry/test.pdf").resolve())
    new_file = add_metadata(
        file,
        orm.Str("changed_test.pdf"),
        orm.Str("test_formula"),
        orm.Str("test_uuid"),
        orm.Str("test_label"),
        orm.Str("test_description"),
    )

    assert new_file.filename == "changed_test.pdf"


def test_analysis():
    silicon = StructureData(ase=bulk("Si", "diamond", 5.43))
    seekpath = seekpath_analysis(silicon, orm.Dict(dict={}))
    kpoints = seekpath["kpoints"]
    dos_data = BandsData()
    dos_data.set_cell_from_structure(silicon)
    dos_data.set_attribute("nspins", 1)
    dos_data.set_attribute("efermi", 4.6597592101172)
    band_data = deepcopy(dos_data)
    dos_data.set_kpoints(
        np.array(
            [
                [-0.45454545, -0.18181818, 0.0],
                [-0.45454545, 0.45454545, 0.45454545],
                [-0.36363636, -0.36363636, -0.09090909],
                [-0.36363636, 0.27272727, -0.18181818],
                [-0.36363636, 0.36363636, 0.36363636],
                [-0.27272727, -0.09090909, 0.27272727],
                [-0.27272727, 0.09090909, 0.18181818],
                [-0.27272727, 0.27272727, 0.0],
                [-0.27272727, 0.36363636, 0.36363636],
                [-0.18181818, -0.18181818, -0.45454545],
                [-0.18181818, -0.18181818, -0.27272727],
                [-0.18181818, -0.18181818, 0.18181818],
                [-0.18181818, -0.09090909, 0.09090909],
                [-0.18181818, 0.0, 0.0],
                [-0.18181818, 0.36363636, -0.45454545],
                [-0.09090909, -0.36363636, 0.27272727],
                [-0.09090909, -0.27272727, 0.0],
                [-0.09090909, -0.18181818, -0.18181818],
                [-0.09090909, -0.09090909, -0.45454545],
                [-0.09090909, -0.09090909, -0.18181818],
                [-0.09090909, -0.09090909, 0.0],
                [-0.09090909, 0.09090909, -0.27272727],
                [-0.09090909, 0.27272727, 0.0],
                [-0.09090909, 0.27272727, 0.18181818],
                [-0.09090909, 0.36363636, 0.36363636],
                [0.0, -0.45454545, -0.45454545],
                [0.0, -0.36363636, -0.36363636],
                [0.0, -0.36363636, -0.09090909],
                [0.0, -0.18181818, -0.27272727],
                [0.0, -0.18181818, -0.18181818],
                [0.0, 0.0, -0.45454545],
                [0.0, 0.0, -0.36363636],
                [0.0, 0.0, -0.09090909],
                [0.0, 0.0, 0.0],
                [0.09090909, -0.45454545, 0.18181818],
                [0.09090909, -0.27272727, 0.45454545],
                [0.18181818, 0.18181818, -0.36363636],
                [0.27272727, -0.36363636, 0.18181818],
                [0.27272727, -0.27272727, 0.45454545],
                [0.27272727, 0.0, 0.0],
                [0.27272727, 0.09090909, -0.18181818],
                [0.27272727, 0.09090909, 0.45454545],
                [0.27272727, 0.27272727, -0.18181818],
                [0.27272727, 0.27272727, 0.0],
                [0.27272727, 0.45454545, -0.09090909],
                [0.36363636, -0.45454545, -0.09090909],
                [0.36363636, -0.45454545, 0.0],
                [0.36363636, -0.18181818, 0.18181818],
                [0.36363636, 0.18181818, 0.18181818],
                [0.36363636, 0.45454545, -0.09090909],
                [0.45454545, -0.18181818, -0.18181818],
                [0.45454545, -0.09090909, -0.27272727],
                [0.45454545, 0.09090909, 0.0],
                [0.45454545, 0.09090909, 0.36363636],
                [0.45454545, 0.45454545, -0.27272727],
                [0.45454545, 0.45454545, -0.09090909],
            ]
        )
    )
    dos_data.set_array(
        "weights",
        np.array(
            [
                0.01803156,
                0.01803156,
                0.01803156,
                0.03606311,
                0.01803156,
                0.03606311,
                0.03606311,
                0.00901578,
                0.00901578,
                0.01803156,
                0.01803156,
                0.01803156,
                0.01803156,
                0.00601052,
                0.01803156,
                0.01803156,
                0.01803156,
                0.01803156,
                0.01803156,
                0.00901578,
                0.00450789,
                0.03606311,
                0.01803156,
                0.01803156,
                0.01803156,
                0.00450789,
                0.00450789,
                0.01803156,
                0.01803156,
                0.00450789,
                0.00601052,
                0.00601052,
                0.00601052,
                0.00075131,
                0.03606311,
                0.03606311,
                0.01803156,
                0.03606311,
                0.01803156,
                0.00601052,
                0.01803156,
                0.03606311,
                0.01803156,
                0.00450789,
                0.03606311,
                0.01803156,
                0.01803156,
                0.01803156,
                0.00901578,
                0.01803156,
                0.01803156,
                0.03606311,
                0.01803156,
                0.01803156,
                0.01803156,
                0.00901578,
            ]
        ),
    )
    dos_data.set_bands(
        np.array(
            [
                [
                    -5.34303410e00,
                    -1.69579338e00,
                    1.63040878e00,
                    2.50034043e00,
                    6.25417984e00,
                    8.82016910e00,
                ],
                [
                    -5.13976070e00,
                    -2.52517925e00,
                    2.45701990e00,
                    3.07151801e00,
                    6.46054119e00,
                    7.67798264e00,
                ],
                [
                    -5.76548513e00,
                    -4.71080505e-01,
                    1.79686626e00,
                    2.11363590e00,
                    5.45950399e00,
                    6.82386025e00,
                ],
                [
                    -4.23866847e00,
                    -2.37699721e00,
                    2.90749295e-01,
                    1.43941914e00,
                    7.77689711e00,
                    8.16565147e00,
                ],
                [
                    -4.53313348e00,
                    -2.24381734e00,
                    1.82511658e-01,
                    2.44563466e00,
                    6.08021093e00,
                    1.01651421e01,
                ],
                [
                    -5.09182485e00,
                    -1.66862553e00,
                    6.11870850e-01,
                    2.47819172e00,
                    7.19108171e00,
                    8.16932719e00,
                ],
                [
                    -5.67473163e00,
                    -1.30376794e00,
                    1.73213827e00,
                    2.91561065e00,
                    7.04800588e00,
                    7.70786999e00,
                ],
                [
                    -5.17554911e00,
                    -1.47644241e00,
                    3.42700728e-01,
                    2.85343237e00,
                    6.54009150e00,
                    9.58577774e00,
                ],
                [
                    -3.92873868e00,
                    -2.71030402e00,
                    -9.23472774e-03,
                    2.05261192e00,
                    5.61132284e00,
                    8.93105658e00,
                ],
                [
                    -5.82174712e00,
                    -8.67590658e-01,
                    1.20979859e00,
                    3.30871313e00,
                    7.00653681e00,
                    8.60909664e00,
                ],
                [
                    -6.89319622e00,
                    1.13600267e00,
                    2.83405024e00,
                    3.99803356e00,
                    7.08755354e00,
                    7.63981513e00,
                ],
                [
                    -6.02972020e00,
                    -4.44379605e-01,
                    2.11265221e00,
                    2.53082779e00,
                    6.22015255e00,
                    8.40789920e00,
                ],
                [
                    -6.85457755e00,
                    1.38358383e00,
                    2.55233948e00,
                    3.58915420e00,
                    6.69355718e00,
                    8.01758725e00,
                ],
                [
                    -7.14051397e00,
                    1.73155295e00,
                    3.90355455e00,
                    3.90416572e00,
                    6.64995148e00,
                    7.66667304e00,
                ],
                [
                    -3.82859072e00,
                    -2.72144871e00,
                    5.23491265e-01,
                    9.10625735e-01,
                    7.33063176e00,
                    7.52962317e00,
                ],
                [
                    -4.42178395e00,
                    -2.20229467e00,
                    5.25770219e-02,
                    2.01382318e00,
                    6.67943202e00,
                    9.43382229e00,
                ],
                [
                    -6.71872444e00,
                    6.06091969e-01,
                    3.19266392e00,
                    3.32397572e00,
                    6.76918360e00,
                    7.67175939e00,
                ],
                [
                    -7.17435677e00,
                    2.23987414e00,
                    3.51314682e00,
                    3.70159138e00,
                    6.63942203e00,
                    7.68789547e00,
                ],
                [
                    -5.63144131e00,
                    -1.76617862e00,
                    2.41878247e00,
                    3.30224144e00,
                    6.56597088e00,
                    7.87226866e00,
                ],
                [
                    -7.28243332e00,
                    2.61801171e00,
                    3.40399869e00,
                    4.27564684e00,
                    7.23857999e00,
                    7.33538178e00,
                ],
                [
                    -7.42577881e00,
                    3.61276607e00,
                    3.91479339e00,
                    3.91523912e00,
                    6.60649381e00,
                    7.62213726e00,
                ],
                [
                    -6.33858629e00,
                    5.30088665e-02,
                    1.98654567e00,
                    3.26512430e00,
                    7.00812487e00,
                    7.95126631e00,
                ],
                [
                    -6.31758318e00,
                    -4.26675606e-01,
                    2.53800452e00,
                    3.63040340e00,
                    6.78688107e00,
                    7.91191293e00,
                ],
                [
                    -6.15273090e00,
                    9.83253466e-02,
                    1.82968156e00,
                    2.56537020e00,
                    6.11449754e00,
                    7.62664319e00,
                ],
                [
                    -4.68116886e00,
                    -1.95240708e00,
                    1.28601523e00,
                    1.73120736e00,
                    5.16314017e00,
                    5.99023213e00,
                ],
                [
                    -4.09442663e00,
                    -2.68495852e00,
                    1.57637241e00,
                    1.57673024e00,
                    4.90728948e00,
                    5.22959446e00,
                ],
                [
                    -5.30681003e00,
                    -1.13415883e00,
                    1.83675733e00,
                    1.83712169e00,
                    4.95704033e00,
                    5.96357667e00,
                ],
                [
                    -6.09247020e00,
                    -9.13095713e-01,
                    2.93863747e00,
                    3.00612797e00,
                    6.62133109e00,
                    7.68392452e00,
                ],
                [
                    -6.60441894e00,
                    9.42201282e-01,
                    2.65112851e00,
                    2.72828449e00,
                    5.98767126e00,
                    8.03994467e00,
                ],
                [
                    -6.99339644e00,
                    2.11202879e00,
                    3.07370200e00,
                    3.07410446e00,
                    5.93515356e00,
                    8.47515649e00,
                ],
                [
                    -5.33661030e00,
                    -2.43010349e00,
                    3.22826430e00,
                    3.22885669e00,
                    5.90383081e00,
                    7.72101799e00,
                ],
                [
                    -5.95594850e00,
                    -1.40349576e00,
                    3.34619273e00,
                    3.34678675e00,
                    6.04021345e00,
                    7.83545166e00,
                ],
                [
                    -7.46222846e00,
                    3.42149534e00,
                    4.24791490e00,
                    4.24855028e00,
                    6.96515347e00,
                    7.19150729e00,
                ],
                [
                    -7.57094067e00,
                    4.41818823e00,
                    4.41818823e00,
                    4.41892430e00,
                    6.94178515e00,
                    6.94181345e00,
                ],
                [
                    -5.05118029e00,
                    -2.29809154e00,
                    1.63451552e00,
                    2.70140644e00,
                    7.03450767e00,
                    7.47923313e00,
                ],
                [
                    -4.03167473e00,
                    -2.60501474e00,
                    1.59094628e-01,
                    1.68569170e00,
                    6.29960163e00,
                    8.99258397e00,
                ],
                [
                    -4.85194533e00,
                    -2.41695658e00,
                    1.29058701e00,
                    2.63371077e00,
                    6.35711969e00,
                    8.68352060e00,
                ],
                [
                    -4.57766219e00,
                    -2.36985313e00,
                    6.27376714e-01,
                    2.17724278e00,
                    6.81762912e00,
                    8.36066105e00,
                ],
                [
                    -3.62418315e00,
                    -2.88852880e00,
                    2.35869102e-01,
                    9.48006015e-01,
                    7.67675078e00,
                    8.95012849e00,
                ],
                [
                    -6.62158987e00,
                    6.22196483e-02,
                    3.57820516e00,
                    3.57880354e00,
                    6.30161582e00,
                    7.90762006e00,
                ],
                [
                    -5.77400883e00,
                    -6.77178447e-01,
                    9.89829370e-01,
                    2.90059215e00,
                    7.65167059e00,
                    7.75857868e00,
                ],
                [
                    -5.53055346e00,
                    -9.90229105e-01,
                    1.24810732e00,
                    2.24441463e00,
                    6.47173867e00,
                    8.04630969e00,
                ],
                [
                    -5.10069658e00,
                    -1.50967240e00,
                    1.05543820e00,
                    2.05281736e00,
                    5.65037091e00,
                    7.59799259e00,
                ],
                [
                    -6.28180484e00,
                    4.88691985e-01,
                    2.34651012e00,
                    2.34688808e00,
                    5.32668658e00,
                    7.11379838e00,
                ],
                [
                    -4.50931154e00,
                    -2.09853766e00,
                    6.91661978e-01,
                    1.56740190e00,
                    6.08362922e00,
                    7.41639442e00,
                ],
                [
                    -3.50577798e00,
                    -3.13163885e00,
                    4.77000614e-01,
                    1.35423227e00,
                    5.94566940e00,
                    7.21170440e00,
                ],
                [
                    -3.99961727e00,
                    -2.67348919e00,
                    4.86607321e-01,
                    1.80587323e00,
                    5.32837315e00,
                    7.19912811e00,
                ],
                [
                    -4.88116709e00,
                    -1.66968025e00,
                    5.75224734e-01,
                    1.76665210e00,
                    7.42422804e00,
                    8.03276604e00,
                ],
                [
                    -6.44294086e00,
                    3.35083989e-01,
                    1.69290516e00,
                    3.72848901e00,
                    7.35988944e00,
                    8.12548475e00,
                ],
                [
                    -4.01945137e00,
                    -2.68055844e00,
                    1.15731626e00,
                    1.28089214e00,
                    5.66507403e00,
                    5.92860705e00,
                ],
                [
                    -5.14208809e00,
                    -1.99866780e00,
                    1.13316507e00,
                    2.91611488e00,
                    6.62073842e00,
                    8.66665171e00,
                ],
                [
                    -4.84984516e00,
                    -2.01345065e00,
                    8.60605223e-01,
                    2.08602287e00,
                    6.60020634e00,
                    8.62317690e00,
                ],
                [
                    -5.41481147e00,
                    -2.11766400e00,
                    2.63749288e00,
                    2.96757596e00,
                    6.48313045e00,
                    7.62799423e00,
                ],
                [
                    -5.19605915e00,
                    -1.27134176e00,
                    1.35034430e00,
                    1.74931246e00,
                    5.74461645e00,
                    6.57903289e00,
                ],
                [
                    -4.47762960e00,
                    -2.32311676e00,
                    4.73800011e-01,
                    2.16746954e00,
                    5.78360383e00,
                    9.08429450e00,
                ],
                [
                    -3.44337574e00,
                    -3.33340691e00,
                    1.11822901e00,
                    1.60185750e00,
                    5.08657904e00,
                    5.68591714e00,
                ],
            ]
        )
    )
    band_data.set_kpointsdata(kpoints)
    band_data.set_array(
        "weights",
        np.array(
            [
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
                0.0049505,
            ]
        ),
    )
    band_data.set_bands(
        np.array(
            [
                [
                    -7.57093931e00,
                    4.41818987e00,
                    4.41818987e00,
                    4.41892594e00,
                    6.94178596e00,
                    6.94178596e00,
                ],
                [
                    -7.56876865e00,
                    4.40332946e00,
                    4.40852683e00,
                    4.40903732e00,
                    6.93624736e00,
                    6.95410537e00,
                ],
                [
                    -7.56225724e00,
                    4.35892646e00,
                    4.38011352e00,
                    4.38060496e00,
                    6.91932351e00,
                    6.99048536e00,
                ],
                [
                    -7.55140697e00,
                    4.28747426e00,
                    4.33453935e00,
                    4.33502262e00,
                    6.89159130e00,
                    7.04932808e00,
                ],
                [
                    -7.53622030e00,
                    4.19222571e00,
                    4.27406749e00,
                    4.27454341e00,
                    6.85372747e00,
                    7.12835647e00,
                ],
                [
                    -7.51670212e00,
                    4.07678141e00,
                    4.20124302e00,
                    4.20171160e00,
                    6.80659871e00,
                    7.22500614e00,
                ],
                [
                    -7.49268236e00,
                    3.94477381e00,
                    4.11879796e00,
                    4.11925947e00,
                    6.75120667e00,
                    7.33674888e00,
                ],
                [
                    -7.46461218e00,
                    3.79891099e00,
                    4.02853345e00,
                    4.02898788e00,
                    6.68828334e00,
                    7.46121348e00,
                ],
                [
                    -7.43214356e00,
                    3.64224824e00,
                    3.93268951e00,
                    3.93313659e00,
                    6.61956044e00,
                    7.59651529e00,
                ],
                [
                    -7.39537118e00,
                    3.47683595e00,
                    3.83288604e00,
                    3.83332632e00,
                    6.54581351e00,
                    7.74123686e00,
                ],
                [
                    -7.35443900e00,
                    3.30417726e00,
                    3.73036823e00,
                    3.73080225e00,
                    6.46804690e00,
                    7.89268536e00,
                ],
                [
                    -7.30909476e00,
                    3.12613017e00,
                    3.62644251e00,
                    3.62687082e00,
                    6.38725467e00,
                    8.05136747e00,
                ],
                [
                    -7.25948079e00,
                    2.94318912e00,
                    3.52187542e00,
                    3.52229801e00,
                    6.30429940e00,
                    8.21536504e00,
                ],
                [
                    -7.20561095e00,
                    2.75697508e00,
                    3.41741608e00,
                    3.41783350e00,
                    6.21997758e00,
                    8.38448679e00,
                ],
                [
                    -7.14750131e00,
                    2.56782085e00,
                    3.31364084e00,
                    3.31405336e00,
                    6.13500676e00,
                    8.55812944e00,
                ],
                [
                    -7.08516819e00,
                    2.37627855e00,
                    3.21103242e00,
                    3.21144059e00,
                    6.05002778e00,
                    8.64778062e00,
                ],
                [
                    -7.01862982e00,
                    2.18279608e00,
                    3.10999083e00,
                    3.11039465e00,
                    5.96561127e00,
                    8.52552123e00,
                ],
                [
                    -6.94790607e00,
                    1.98773481e00,
                    3.01084751e00,
                    3.01124752e00,
                    5.88226415e00,
                    8.38127748e00,
                ],
                [
                    -6.87301817e00,
                    1.79092520e00,
                    2.91385144e00,
                    2.91424764e00,
                    5.80043680e00,
                    8.22281906e00,
                ],
                [
                    -6.79398868e00,
                    1.59353898e00,
                    2.81933596e00,
                    2.81972889e00,
                    5.72054145e00,
                    8.05733656e00,
                ],
                [
                    -6.71084375e00,
                    1.39532962e00,
                    2.72738651e00,
                    2.72777645e00,
                    5.64290900e00,
                    7.88589612e00,
                ],
                [
                    -6.62360868e00,
                    1.19648487e00,
                    2.63821916e00,
                    2.63860637e00,
                    5.56787034e00,
                    7.71296668e00,
                ],
                [
                    -6.53231203e00,
                    9.97170729e-01,
                    2.55198138e00,
                    2.55236588e00,
                    5.49570929e00,
                    7.54061739e00,
                ],
                [
                    -6.43698375e00,
                    7.97532498e-01,
                    2.46879971e00,
                    2.46918122e00,
                    5.42668026e00,
                    7.37035167e00,
                ],
                [
                    -6.33765593e00,
                    5.97714127e-01,
                    2.38878545e00,
                    2.38916451e00,
                    5.36101375e00,
                    7.20327866e00,
                ],
                [
                    -6.23436288e00,
                    3.97847320e-01,
                    2.31203520e00,
                    2.31241207e00,
                    5.29891737e00,
                    7.04022886e00,
                ],
                [
                    -6.12704117e00,
                    1.98100244e-01,
                    2.23864255e00,
                    2.23901725e00,
                    5.24070895e00,
                    6.88224936e00,
                ],
                [
                    -6.01593328e00,
                    -1.47893878e-03,
                    2.16866494e00,
                    2.16903773e00,
                    5.18630359e00,
                    6.72896409e00,
                ],
                [
                    -5.90115647e00,
                    -2.00728864e-01,
                    2.10216521e00,
                    2.10253637e00,
                    5.13529068e00,
                    6.58103483e00,
                ],
                [
                    -5.78240000e00,
                    -3.99508031e-01,
                    2.03922909e00,
                    2.03959862e00,
                    5.08918044e00,
                    6.43902243e00,
                ],
                [
                    -5.65988374e00,
                    -5.97695351e-01,
                    1.97989357e00,
                    1.98026147e00,
                    5.04744389e00,
                    6.30299951e00,
                ],
                [
                    -5.53365583e00,
                    -7.95161298e-01,
                    1.92420466e00,
                    1.92457147e00,
                    5.01020838e00,
                    6.17312284e00,
                ],
                [
                    -5.40352800e00,
                    -9.91775528e-01,
                    1.87224234e00,
                    1.87260752e00,
                    4.97779091e00,
                    6.04950533e00,
                ],
                [
                    -5.27005153e00,
                    -1.18740579e00,
                    1.82396254e00,
                    1.82432663e00,
                    4.94991448e00,
                    5.93222344e00,
                ],
                [
                    -5.13308955e00,
                    -1.38220911e00,
                    1.77940880e00,
                    1.77977152e00,
                    4.92626588e00,
                    5.82098221e00,
                ],
                [
                    -4.99257731e00,
                    -1.57549375e00,
                    1.73866709e00,
                    1.73902873e00,
                    4.90813875e00,
                    5.71648859e00,
                ],
                [
                    -4.84864051e00,
                    -1.76739960e00,
                    1.70173553e00,
                    1.70209635e00,
                    4.89505334e00,
                    5.61840624e00,
                ],
                [
                    -4.70134664e00,
                    -1.95779548e00,
                    1.66863615e00,
                    1.66899615e00,
                    4.88710435e00,
                    5.52672265e00,
                ],
                [
                    -4.55076673e00,
                    -2.14655215e00,
                    1.63938853e00,
                    1.63974772e00,
                    4.88438457e00,
                    5.44141169e00,
                ],
                [
                    -4.39697451e00,
                    -2.33354117e00,
                    1.61400902e00,
                    1.61436766e00,
                    4.88698380e00,
                    5.36243636e00,
                ],
                [
                    -4.23973216e00,
                    -2.51842457e00,
                    1.59253869e00,
                    1.59289706e00,
                    4.89525606e00,
                    5.29026605e00,
                ],
                [
                    -4.07975861e00,
                    -2.70151556e00,
                    1.57493429e00,
                    1.57529212e00,
                    4.90874638e00,
                    5.22381041e00,
                ],
                [
                    -3.91681901e00,
                    -2.88246909e00,
                    1.56123308e00,
                    1.56159064e00,
                    4.92781339e00,
                    5.16353011e00,
                ],
                [
                    -3.75100399e00,
                    -3.06116925e00,
                    1.55144242e00,
                    1.55179998e00,
                    4.95253902e00,
                    5.10936095e00,
                ],
                [
                    -3.58240741e00,
                    -3.23750148e00,
                    1.54556749e00,
                    1.54592477e00,
                    4.98300325e00,
                    5.06123517e00,
                ],
                [
                    -3.41232837e00,
                    -3.41040969e00,
                    1.54358731e00,
                    1.54394487e00,
                    5.01830703e00,
                    5.01948719e00,
                ],
                [
                    -3.41247313e00,
                    -3.40833809e00,
                    1.52649530e00,
                    1.54557647e00,
                    5.02129593e00,
                    5.04447051e00,
                ],
                [
                    -3.41519155e00,
                    -3.40062040e00,
                    1.47576103e00,
                    1.55147263e00,
                    5.02814150e00,
                    5.11920821e00,
                ],
                [
                    -3.42016470e00,
                    -3.38750832e00,
                    1.39625698e00,
                    1.56129186e00,
                    5.03952892e00,
                    5.23873667e00,
                ],
                [
                    -3.42750878e00,
                    -3.36952459e00,
                    1.29411959e00,
                    1.57496259e00,
                    5.05538173e00,
                    5.39775755e00,
                ],
                [
                    -3.43758951e00,
                    -3.34588660e00,
                    1.17576340e00,
                    1.59257434e00,
                    5.07580850e00,
                    5.58943754e00,
                ],
                [
                    -3.45104989e00,
                    -3.31699654e00,
                    1.04716566e00,
                    1.61405011e00,
                    5.10072787e00,
                    5.80849300e00,
                ],
                [
                    -3.46809293e00,
                    -3.28285986e00,
                    9.13576538e-01,
                    1.63935833e00,
                    5.13010882e00,
                    6.05021881e00,
                ],
                [
                    -3.48952625e00,
                    -3.24348335e00,
                    7.79335156e-01,
                    1.66846199e00,
                    5.16391379e00,
                    6.31080700e00,
                ],
                [
                    -3.51604592e00,
                    -3.19887301e00,
                    6.48061448e-01,
                    1.70131620e00,
                    5.20209790e00,
                    6.58723168e00,
                ],
                [
                    -3.54837822e00,
                    -3.14903645e00,
                    5.22754653e-01,
                    1.73787007e00,
                    5.24460916e00,
                    6.87709225e00,
                ],
                [
                    -3.58724097e00,
                    -3.09398183e00,
                    4.05897265e-01,
                    1.77806510e00,
                    5.29138634e00,
                    7.17846025e00,
                ],
                [
                    -3.63329787e00,
                    -3.03371786e00,
                    2.99527960e-01,
                    1.82183488e00,
                    5.34235925e00,
                    7.48974870e00,
                ],
                [
                    -3.68715546e00,
                    -2.96836618e00,
                    2.05254661e-01,
                    1.86909861e00,
                    5.39731292e00,
                    7.80921498e00,
                ],
                [
                    -3.74912477e00,
                    -2.89771645e00,
                    1.24381608e-01,
                    1.91978471e00,
                    5.45641877e00,
                    8.13633611e00,
                ],
                [
                    -3.81945014e00,
                    -2.82189002e00,
                    5.77629676e-02,
                    1.97379469e00,
                    5.51944360e00,
                    8.46952972e00,
                ],
                [
                    -3.81944960e00,
                    -2.82189002e00,
                    5.77629676e-02,
                    1.97379496e00,
                    5.51944360e00,
                    8.46952999e00,
                ],
                [
                    -3.89295354e00,
                    -2.74624264e00,
                    8.71335761e-03,
                    2.02735622e00,
                    5.58182679e00,
                    8.78615786e00,
                ],
                [
                    -3.97357951e00,
                    -2.66594157e00,
                    -2.71833573e-02,
                    2.08365439e00,
                    5.64758473e00,
                    9.10540292e00,
                ],
                [
                    -4.06128398e00,
                    -2.58114083e00,
                    -5.00069065e-02,
                    2.14255017e00,
                    5.71643035e00,
                    9.42455545e00,
                ],
                [
                    -4.15490475e00,
                    -2.49182599e00,
                    -6.00274991e-02,
                    2.20400083e00,
                    5.78824637e00,
                    9.74033297e00,
                ],
                [
                    -4.25427882e00,
                    -2.39777038e00,
                    -5.75724879e-02,
                    2.26786459e00,
                    5.86330244e00,
                    1.00435105e01,
                ],
                [
                    -4.35845979e00,
                    -2.29951007e00,
                    -4.33705939e-02,
                    2.33397410e00,
                    5.94051665e00,
                    1.03126874e01,
                ],
                [
                    -4.46671130e00,
                    -2.19679661e00,
                    -1.79235951e-02,
                    2.40221209e00,
                    6.02015812e00,
                    1.04958799e01,
                ],
                [
                    -4.57851173e00,
                    -2.08964716e00,
                    1.81154354e-02,
                    2.47240087e00,
                    6.10194439e00,
                    1.03947219e01,
                ],
                [
                    -4.69301424e00,
                    -1.97808157e00,
                    6.41040367e-02,
                    2.54437879e00,
                    6.18562892e00,
                    1.02281210e01,
                ],
                [
                    -4.80951979e00,
                    -1.86212052e00,
                    1.19406551e-01,
                    2.61796110e00,
                    6.27090450e00,
                    1.00652089e01,
                ],
                [
                    -4.92737502e00,
                    -1.74178661e00,
                    1.83413443e-01,
                    2.69294887e00,
                    6.35742174e00,
                    9.90605520e00,
                ],
                [
                    -5.04597584e00,
                    -1.61710377e00,
                    2.55550008e-01,
                    2.76912823e00,
                    6.44478199e00,
                    9.75072091e00,
                ],
                [
                    -5.16478456e00,
                    -1.48826494e00,
                    3.35230658e-01,
                    2.84596801e00,
                    6.53218740e00,
                    9.59901445e00,
                ],
                [
                    -5.28327871e00,
                    -1.35496697e00,
                    4.22048038e-01,
                    2.92381815e00,
                    6.61980262e00,
                    9.45147541e00,
                ],
                [
                    -5.40109340e00,
                    -1.21702756e00,
                    5.15553704e-01,
                    3.00213007e00,
                    6.70699361e00,
                    9.30808148e00,
                ],
                [
                    -5.51770643e00,
                    -1.07525489e00,
                    6.15195265e-01,
                    3.08063219e00,
                    6.79254158e00,
                    9.16850639e00,
                ],
                [
                    -5.63281875e00,
                    -9.29284582e-01,
                    7.20639927e-01,
                    3.15903935e00,
                    6.87600897e00,
                    9.03297655e00,
                ],
                [
                    -5.74611444e00,
                    -7.79160459e-01,
                    8.31512443e-01,
                    3.23705603e00,
                    6.95660311e00,
                    8.90152433e00,
                ],
                [
                    -5.85729390e00,
                    -6.25030004e-01,
                    9.47501516e-01,
                    3.31441935e00,
                    7.03339962e00,
                    8.77433451e00,
                ],
                [
                    -5.96615277e00,
                    -4.66727772e-01,
                    1.06817666e00,
                    3.39073341e00,
                    7.10564802e00,
                    8.65111428e00,
                ],
                [
                    -6.07244425e00,
                    -3.04412132e-01,
                    1.19325815e00,
                    3.46572690e00,
                    7.17238367e00,
                    8.53205413e00,
                ],
                [
                    -6.17597160e00,
                    -1.37920361e-01,
                    1.32245508e00,
                    3.53913342e00,
                    7.23326153e00,
                    8.41737556e00,
                ],
                [
                    -6.27656120e00,
                    3.22373279e-02,
                    1.45538433e00,
                    3.61055269e00,
                    7.28646931e00,
                    8.30669870e00,
                ],
                [
                    -6.37405688e00,
                    2.06210053e-01,
                    1.59175473e00,
                    3.67973764e00,
                    7.33193001e00,
                    8.20024476e00,
                ],
                [
                    -6.46824473e00,
                    3.83927336e-01,
                    1.73125254e00,
                    3.74641506e00,
                    7.36925750e00,
                    8.09808669e00,
                ],
                [
                    -6.55926600e00,
                    5.65149447e-01,
                    1.87349597e00,
                    3.81028290e00,
                    7.39801259e00,
                    8.00011564e00,
                ],
                [
                    -6.64671332e00,
                    7.50020331e-01,
                    2.01814734e00,
                    3.87118987e00,
                    7.41885869e00,
                    7.90642194e00,
                ],
                [
                    -6.73059405e00,
                    9.38295360e-01,
                    2.16482351e00,
                    3.92890767e00,
                    7.43193267e00,
                    7.81701241e00,
                ],
                [
                    -6.81082001e00,
                    1.12981589e00,
                    2.31306515e00,
                    3.98321180e00,
                    7.43736651e00,
                    7.73185955e00,
                ],
                [
                    -6.88731149e00,
                    1.32443906e00,
                    2.46251742e00,
                    4.03412076e00,
                    7.43679561e00,
                    7.65105207e00,
                ],
                [
                    -6.95991718e00,
                    1.52214365e00,
                    2.61264835e00,
                    4.08151238e00,
                    7.43076802e00,
                    7.57461910e00,
                ],
                [
                    -7.02873450e00,
                    1.72255033e00,
                    2.76293574e00,
                    4.12534693e00,
                    7.42000592e00,
                    7.50264744e00,
                ],
                [
                    -7.09362467e00,
                    1.92504440e00,
                    2.91275292e00,
                    4.16558794e00,
                    7.40519041e00,
                    7.43481762e00,
                ],
                [
                    -7.15453573e00,
                    2.12953116e00,
                    3.06145116e00,
                    4.20231215e00,
                    7.37133155e00,
                    7.38719769e00,
                ],
                [
                    -7.21142140e00,
                    2.33557005e00,
                    3.20828815e00,
                    4.23559875e00,
                    7.31219631e00,
                    7.36665419e00,
                ],
                [
                    -7.26424060e00,
                    2.54260896e00,
                    3.35243148e00,
                    4.26555549e00,
                    7.25741844e00,
                    7.34404697e00,
                ],
                [
                    -7.31295633e00,
                    2.74994965e00,
                    3.49294590e00,
                    4.29231354e00,
                    7.20700363e00,
                    7.31969577e00,
                ],
                [
                    -7.35738898e00,
                    2.95676760e00,
                    3.62889970e00,
                    4.31622445e00,
                    7.16134129e00,
                    7.29374237e00,
                ],
                [
                    -7.39780769e00,
                    3.16192158e00,
                    3.75887325e00,
                    4.33703899e00,
                    7.11964529e00,
                    7.23802407e00,
                ],
                [
                    -7.43394713e00,
                    3.36375278e00,
                    3.88168340e00,
                    4.35512122e00,
                    7.08239481e00,
                    7.18312591e00,
                ],
                [
                    -7.46596567e00,
                    3.56005680e00,
                    3.99588278e00,
                    4.37063171e00,
                    7.04945216e00,
                    7.13205858e00,
                ],
                [
                    -7.49372102e00,
                    3.74830815e00,
                    4.09995408e00,
                    4.38372365e00,
                    7.02089572e00,
                    7.08564983e00,
                ],
                [
                    -7.51725941e00,
                    3.92472664e00,
                    4.19212013e00,
                    4.39453882e00,
                    6.99672793e00,
                    7.04443302e00,
                ],
                [
                    -7.53653541e00,
                    4.08445638e00,
                    4.27070552e00,
                    4.40320401e00,
                    6.97695123e00,
                    7.00914502e00,
                ],
                [
                    -7.55163065e00,
                    4.22100746e00,
                    4.33389988e00,
                    4.40982699e00,
                    6.96156755e00,
                    6.98056028e00,
                ],
                [
                    -7.56235575e00,
                    4.32725595e00,
                    4.38040631e00,
                    4.41449456e00,
                    6.95057796e00,
                    6.95944697e00,
                ],
                [
                    -7.56879315e00,
                    4.39521230e00,
                    4.40886453e00,
                    4.41726931e00,
                    6.94398410e00,
                    6.94646877e00,
                ],
                [
                    -7.57093931e00,
                    4.41818987e00,
                    4.41818987e00,
                    4.41892566e00,
                    6.94178596e00,
                    6.94178596e00,
                ],
                [
                    -7.56877192e00,
                    4.39233660e00,
                    4.41434898e00,
                    4.41434925e00,
                    6.94736838e00,
                    6.94736865e00,
                ],
                [
                    -7.56227139e00,
                    4.31531505e00,
                    4.40295693e00,
                    4.40295693e00,
                    6.96394773e00,
                    6.96394773e00,
                ],
                [
                    -7.55144181e00,
                    4.19488181e00,
                    4.38438870e00,
                    4.38438870e00,
                    6.98811334e00,
                    6.99103285e00,
                ],
                [
                    -7.53624806e00,
                    4.03989692e00,
                    4.35922334e00,
                    4.35922334e00,
                    7.00087848e00,
                    7.02784959e00,
                ],
                [
                    -7.51678756e00,
                    3.85835834e00,
                    4.32818631e00,
                    4.32818631e00,
                    7.00177645e00,
                    7.07339383e00,
                ],
                [
                    -7.49302876e00,
                    3.65730457e00,
                    4.29208687e00,
                    4.29208714e00,
                    6.99033733e00,
                    7.12649086e00,
                ],
                [
                    -7.46498879e00,
                    3.44207150e00,
                    4.25176259e00,
                    4.25176286e00,
                    6.96818781e00,
                    7.18584433e00,
                ],
                [
                    -7.43273350e00,
                    3.21666082e00,
                    4.20797947e00,
                    4.20797947e00,
                    6.93736466e00,
                    7.24997231e00,
                ],
                [
                    -7.39631596e00,
                    2.98390307e00,
                    4.16160147e00,
                    4.16160147e00,
                    6.89933049e00,
                    7.31757465e00,
                ],
                [
                    -7.35544255e00,
                    2.74645543e00,
                    4.11353011e00,
                    4.11353011e00,
                    6.85698576e00,
                    7.38722708e00,
                ],
                [
                    -7.31053207e00,
                    2.50581482e00,
                    4.06395532e00,
                    4.06395532e00,
                    6.81099498e00,
                    7.45737858e00,
                ],
                [
                    -7.26163076e00,
                    2.26257823e00,
                    4.01358950e00,
                    4.01358977e00,
                    6.76147598e00,
                    7.52617903e00,
                ],
                [
                    -7.20850243e00,
                    2.01926954e00,
                    3.96304000e00,
                    3.96304027e00,
                    6.71116049e00,
                    7.59288937e00,
                ],
                [
                    -7.15133812e00,
                    1.77602969e00,
                    3.91266601e00,
                    3.91266601e00,
                    6.65986458e00,
                    7.65573216e00,
                ],
                [
                    -7.09019930e00,
                    1.53356373e00,
                    3.86282700e00,
                    3.86282700e00,
                    6.60818527e00,
                    7.71340043e00,
                ],
                [
                    -7.02515620e00,
                    1.29246569e00,
                    3.81382936e00,
                    3.81382936e00,
                    6.55662296e00,
                    7.76475158e00,
                ],
                [
                    -6.95636065e00,
                    1.05324659e00,
                    3.76584807e00,
                    3.76584807e00,
                    6.50550936e00,
                    7.80864491e00,
                ],
                [
                    -6.88377129e00,
                    8.16367130e-01,
                    3.71927252e00,
                    3.71927252e00,
                    6.45537293e00,
                    7.84488884e00,
                ],
                [
                    -6.80756744e00,
                    5.82240645e-01,
                    3.67422380e00,
                    3.67422380e00,
                    6.40700524e00,
                    7.87299575e00,
                ],
                [
                    -6.72788107e00,
                    3.51254626e-01,
                    3.63081973e00,
                    3.63081973e00,
                    6.35948382e00,
                    7.89298986e00,
                ],
                [
                    -6.64479247e00,
                    1.23853980e-01,
                    3.58922523e00,
                    3.58922523e00,
                    6.31431591e00,
                    7.90523743e00,
                ],
                [
                    -6.55863878e00,
                    -9.97310868e-02,
                    3.54951973e00,
                    3.54951973e00,
                    6.27027265e00,
                    7.91035780e00,
                ],
                [
                    -6.46956013e00,
                    -3.19044238e-01,
                    3.51180992e00,
                    3.51180992e00,
                    6.22822100e00,
                    7.90916839e00,
                ],
                [
                    -6.37793014e00,
                    -5.33680568e-01,
                    3.47616192e00,
                    3.47616219e00,
                    6.18780284e00,
                    7.90253561e00,
                ],
                [
                    -6.28384841e00,
                    -7.43198165e-01,
                    3.44265573e00,
                    3.44265573e00,
                    6.15008677e00,
                    7.89159228e00,
                ],
                [
                    -6.18780882e00,
                    -9.47101781e-01,
                    3.41133189e00,
                    3.41133216e00,
                    6.11469455e00,
                    7.87725596e00,
                ],
                [
                    -6.09028404e00,
                    -1.14482297e00,
                    3.38223149e00,
                    3.38223149e00,
                    6.08170320e00,
                    7.86047225e00,
                ],
                [
                    -5.99185665e00,
                    -1.33569587e00,
                    3.35538718e00,
                    3.35538718e00,
                    6.05117855e00,
                    7.84211709e00,
                ],
                [
                    -5.89324640e00,
                    -1.51892754e00,
                    3.33082428e00,
                    3.33082428e00,
                    6.02317423e00,
                    7.82298367e00,
                ],
                [
                    -5.79534718e00,
                    -1.69347062e00,
                    3.30868918e00,
                    3.30868918e00,
                    5.99813458e00,
                    7.80409435e00,
                ],
                [
                    -5.69927058e00,
                    -1.85833950e00,
                    3.28873752e00,
                    3.28873752e00,
                    5.97529607e00,
                    7.78541591e00,
                ],
                [
                    -5.60640901e00,
                    -2.01207593e00,
                    3.27111352e00,
                    3.27111379e00,
                    5.95373540e00,
                    7.76779844e00,
                ],
                [
                    -5.51841283e00,
                    -2.15284043e00,
                    3.25582916e00,
                    3.25582916e00,
                    5.93613344e00,
                    7.75169665e00,
                ],
                [
                    -5.43733297e00,
                    -2.27862152e00,
                    3.24288879e00,
                    3.24288879e00,
                    5.92120990e00,
                    7.73748006e00,
                ],
                [
                    -5.36553927e00,
                    -2.38702079e00,
                    3.23229730e00,
                    3.23229730e00,
                    5.90898029e00,
                    7.72545317e00,
                ],
                [
                    -5.30565545e00,
                    -2.47539221e00,
                    3.22405769e00,
                    3.22405769e00,
                    5.89945740e00,
                    7.71585735e00,
                ],
                [
                    -5.26035475e00,
                    -2.54104431e00,
                    3.21817160e00,
                    3.21817160e00,
                    5.89265047e00,
                    7.70887599e00,
                ],
                [
                    -5.23242254e00,
                    -2.58179227e00,
                    3.21457833e00,
                    3.21457833e00,
                    5.88839297e00,
                    7.70460626e00,
                ],
                [
                    -5.22278916e00,
                    -2.59550408e00,
                    3.21340035e00,
                    3.21340035e00,
                    5.88702941e00,
                    7.70318473e00,
                ],
                [
                    -5.22043157e00,
                    -2.59424311e00,
                    3.19081708e00,
                    3.20906204e00,
                    5.90797184e00,
                    7.69872833e00,
                ],
                [
                    -5.21337566e00,
                    -2.59035515e00,
                    3.12552908e00,
                    3.19601990e00,
                    5.96803172e00,
                    7.68571448e00,
                ],
                [
                    -5.20197517e00,
                    -2.58414551e00,
                    3.02371659e00,
                    3.17423283e00,
                    6.05978007e00,
                    7.66516744e00,
                ],
                [
                    -5.18588182e00,
                    -2.57551079e00,
                    2.89330439e00,
                    3.14376016e00,
                    6.17391034e00,
                    7.63867361e00,
                ],
                [
                    -5.16539055e00,
                    -2.56470406e00,
                    2.74188120e00,
                    3.10462583e00,
                    6.30069825e00,
                    7.60809645e00,
                ],
                [
                    -5.14039254e00,
                    -2.55186355e00,
                    2.57585610e00,
                    3.05691285e00,
                    6.43190692e00,
                    7.57549885e00,
                ],
                [
                    -5.11087282e00,
                    -2.53718900e00,
                    2.40035709e00,
                    3.00077277e00,
                    6.56105569e00,
                    7.54288301e00,
                ],
                [
                    -5.07686920e00,
                    -2.52091577e00,
                    2.21953526e00,
                    2.93641131e00,
                    6.68438640e00,
                    7.51222721e00,
                ],
                [
                    -5.03838386e00,
                    -2.50339327e00,
                    2.03640264e00,
                    2.86418604e00,
                    6.80012676e00,
                    7.48542018e00,
                ],
                [
                    -4.99551967e00,
                    -2.48511756e00,
                    1.85335873e00,
                    2.78429967e00,
                    6.90799813e00,
                    7.46283147e00,
                ],
                [
                    -4.94825758e00,
                    -2.46650879e00,
                    1.67250914e00,
                    2.69734814e00,
                    7.00927401e00,
                    7.44671172e00,
                ],
                [
                    -4.89673364e00,
                    -2.44819743e00,
                    1.49559160e00,
                    2.60383050e00,
                    7.10553782e00,
                    7.43744733e00,
                ],
                [
                    -4.84084363e00,
                    -2.43089861e00,
                    1.32425620e00,
                    2.50438268e00,
                    7.19845871e00,
                    7.43573029e00,
                ],
                [
                    -4.78072144e00,
                    -2.41545506e00,
                    1.16001971e00,
                    2.39966130e00,
                    7.28950665e00,
                    7.44190319e00,
                ],
                [
                    -4.71655835e00,
                    -2.40305129e00,
                    1.00418392e00,
                    2.29032105e00,
                    7.37973225e00,
                    7.45555297e00,
                ],
                [
                    -4.64789641e00,
                    -2.39437385e00,
                    8.58740155e-01,
                    2.17723217e00,
                    7.47047569e00,
                    7.47808154e00,
                ],
                [
                    -4.57553371e00,
                    -2.39088644e00,
                    7.24983680e-01,
                    2.06103547e00,
                    7.50865462e00,
                    7.56224418e00,
                ],
                [
                    -4.49926701e00,
                    -2.39386065e00,
                    6.04494116e-01,
                    1.94250486e00,
                    7.54724418e00,
                    7.65560644e00,
                ],
                [
                    -4.41921764e00,
                    -2.40466193e00,
                    4.98653257e-01,
                    1.82237312e00,
                    7.59356993e00,
                    7.75086616e00,
                ],
                [
                    -4.33550290e00,
                    -2.42436760e00,
                    4.09063309e-01,
                    1.70137688e00,
                    7.64759732e00,
                    7.84839230e00,
                ],
                [
                    -4.24821422e00,
                    -2.45398339e00,
                    3.36707148e-01,
                    1.58020105e00,
                    7.70889096e00,
                    7.94817645e00,
                ],
                [
                    -4.15767242e00,
                    -2.49418603e00,
                    2.82283017e-01,
                    1.45957624e00,
                    7.77730256e00,
                    8.05016908e00,
                ],
                [
                    -4.06400730e00,
                    -2.54513717e00,
                    2.46046704e-01,
                    1.34016507e00,
                    7.85243564e00,
                    8.15404772e00,
                ],
                [
                    -3.96742593e00,
                    -2.60651626e00,
                    2.27748953e-01,
                    1.22266059e00,
                    7.93409783e00,
                    8.25921374e00,
                ],
                [
                    -3.86827390e00,
                    -2.67768383e00,
                    2.26683627e-01,
                    1.10769657e00,
                    8.02147767e00,
                    8.36430629e00,
                ],
                [
                    -3.76697652e00,
                    -2.75759904e00,
                    2.41782952e-01,
                    9.95971523e-01,
                    8.11401406e00,
                    8.46687579e00,
                ],
                [
                    -3.66366796e00,
                    -2.84490922e00,
                    2.71763912e-01,
                    8.88202466e-01,
                    8.21128143e00,
                    8.56198094e00,
                ],
                [
                    -3.55893052e00,
                    -2.93830985e00,
                    3.15218589e-01,
                    7.85124378e-01,
                    8.31188954e00,
                    8.63906917e00,
                ],
                [
                    -3.45329347e00,
                    -3.03635084e00,
                    3.70740155e-01,
                    6.87531290e-01,
                    8.41378039e00,
                    8.67933195e00,
                ],
                [
                    -3.34731220e00,
                    -3.13776631e00,
                    4.36998245e-01,
                    5.96347844e-01,
                    8.51329379e00,
                    8.66501168e00,
                ],
                [
                    -3.24289232e00,
                    -3.24082970e00,
                    5.12361536e-01,
                    5.12682359e-01,
                    8.60165405e00,
                    8.60277843e00,
                ],
                [
                    -3.24384880e00,
                    -3.24178727e00,
                    5.16534947e-01,
                    5.16855769e-01,
                    8.51650419e00,
                    8.51762203e00,
                ],
                [
                    -3.24688423e00,
                    -3.24482406e00,
                    5.28984972e-01,
                    5.29306066e-01,
                    8.32622123e00,
                    8.32733010e00,
                ],
                [
                    -3.25153765e00,
                    -3.24948210e00,
                    5.49607120e-01,
                    5.49927942e-01,
                    8.10063014e00,
                    8.10173030e00,
                ],
                [
                    -3.25787546e00,
                    -3.25582589e00,
                    5.78140434e-01,
                    5.78461528e-01,
                    7.86445736e00,
                    7.86555044e00,
                ],
                [
                    -3.26573138e00,
                    -3.26368917e00,
                    6.14251302e-01,
                    6.14572669e-01,
                    7.62657108e00,
                    7.62765845e00,
                ],
                [
                    -3.27478053e00,
                    -3.27274865e00,
                    6.57558766e-01,
                    6.57880677e-01,
                    7.39091042e00,
                    7.39199533e00,
                ],
                [
                    -3.28496521e00,
                    -3.28294422e00,
                    7.07472337e-01,
                    7.07794792e-01,
                    7.15955106e00,
                    7.16063407e00,
                ],
                [
                    -3.29614800e00,
                    -3.29413599e00,
                    7.63361257e-01,
                    7.63684528e-01,
                    6.93346554e00,
                    6.93454692e00,
                ],
                [
                    -3.30785896e00,
                    -3.30585729e00,
                    8.24587962e-01,
                    8.24912321e-01,
                    6.71401007e00,
                    6.71509145e00,
                ],
                [
                    -3.31989782e00,
                    -3.31790649e00,
                    8.90316246e-01,
                    8.90642238e-01,
                    6.50211365e00,
                    6.50319667e00,
                ],
                [
                    -3.33200961e00,
                    -3.33002889e00,
                    9.59616841e-01,
                    9.59945010e-01,
                    6.29873712e00,
                    6.29982340e00,
                ],
                [
                    -3.34394888e00,
                    -3.34197768e00,
                    1.03142850e00,
                    1.03175885e00,
                    6.10490879e00,
                    6.10599970e00,
                ],
                [
                    -3.35548324e00,
                    -3.35352157e00,
                    1.10453978e00,
                    1.10487230e00,
                    5.92177182e00,
                    5.92286925e00,
                ],
                [
                    -3.36639691e00,
                    -3.36444395e00,
                    1.17756888e00,
                    1.17790439e00,
                    5.75062064e00,
                    5.75172624e00,
                ],
                [
                    -3.37636526e00,
                    -3.37441991e00,
                    1.24895114e00,
                    1.24928938e00,
                    5.59316278e00,
                    5.59428117e00,
                ],
                [
                    -3.38547291e00,
                    -3.38353464e00,
                    1.31692736e00,
                    1.31726886e00,
                    5.45058818e00,
                    5.45171664e00,
                ],
                [
                    -3.39343686e00,
                    -3.39150513e00,
                    1.37956770e00,
                    1.37991274e00,
                    5.32498370e00,
                    5.32612331e00,
                ],
                [
                    -3.39997168e00,
                    -3.39804457e00,
                    1.43485198e00,
                    1.43520029e00,
                    5.21866038e00,
                    5.21981550e00,
                ],
                [
                    -3.40522102e00,
                    -3.40329745e00,
                    1.48064765e00,
                    1.48099922e00,
                    5.13262505e00,
                    5.13379133e00,
                ],
                [
                    -3.40908205e00,
                    -3.40716283e00,
                    1.51502107e00,
                    1.51537591e00,
                    5.06977111e00,
                    5.07094582e00,
                ],
                [
                    -3.41142168e00,
                    -3.40950437e00,
                    1.53636841e00,
                    1.53672460e00,
                    5.03135271e00,
                    5.03253260e00,
                ],
                [
                    -3.41232837e00,
                    -3.41040969e00,
                    1.54358731e00,
                    1.54394487e00,
                    5.01830703e00,
                    5.01948719e00,
                ],
            ]
        )
    )
    results = analysis(dos_data, band_data, kpoints, orm.Str("Si2_pbesol"))

    assert "dos_plot" in results
    assert "labelled_bands" in results
    assert "band_plot" in results


def test_band_plot_wc(mock_castep_code):
    bands = WorkflowFactory("castep_addons.band_plot")
    bld = bands.get_builder()
    bld.calc.code = mock_castep_code
    upload_otfg_family(["C19"], "C19", "C19 potential library")
    bld.pseudos_family = "C19"
    bld.calc.parameters = {
        "xc_functional": "pbesol",
        "cut_off_energy": 250,
        "symmetry_generate": True,
    }
    bld.kpoints_spacing = 0.09
    silicon = StructureData(ase=bulk("Si", "diamond", 5.43))
    bld.calc.structure = silicon
    bld.calc_options = {
        "max_wallclock_seconds": 3600,
        "resources": {"num_machines": 1, "tot_num_mpiprocs": 4},
    }
    bld.metadata.label = "Si_pbesol_dos+bands"
    bld.metadata.description = (
        "Density of states and band structure of silicon with PBEsol functional"
    )
    bld.clean_workdir = True
    _, si_node = run_get_node(bld)

    bld.calc.parameters = {
        "xc_functional": "pbesol",
        "cut_off_energy": 450,
        "spin": 1,
        "spin_polarized": True,
        "symmetry_generate": True,
    }
    bld.kpoints_spacing = 0.07
    iron = StructureData(ase=bulk("Fe", "bcc", 2.87))
    bld.calc.structure = iron
    bld.metadata.label = "Fe_pbesol_dos+bands"
    bld.metadata.description = (
        "Density of states and band structure of iron with PBEsol functional"
    )
    _, fe_node = run_get_node(bld)

    assert si_node.exit_status == 0
    assert fe_node.exit_status == 0
